version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd war-markets-react
        - npm ci
    build:
      commands:
        - npm run build
        - cd ..
        - mkdir -p _site/react
        - cp docs/index.html _site/
        - cp docs/d3.html _site/ 2>/dev/null || true
        - cp -r war-markets-react/dist/* _site/react/
        - cp war_drawdowns.html _site/ 2>/dev/null || true
  artifacts:
    baseDirectory: _site
    files:
      - '**/*'
  cache:
    paths:
      - war-markets-react/node_modules/**/*
